# üöÄ Backend Ecommerce - Proyecto Final Coderhouse

Este proyecto es una API REST profesional para una plataforma de E-commerce, desarrollada para el curso de **Programaci√≥n Backend II**. La arquitectura se basa en capas para garantizar escalabilidad, seguridad y mantenimiento.

## üõ†Ô∏è Tecnolog√≠as Utilizadas

* **Runtime:** [Node.js](https://nodejs.org/) (v24+)
* **Framework:** [Express.js](https://expressjs.com/)
* **Base de Datos:** [MongoDB](https://www.mongodb.com/) con [Mongoose](https://mongoosejs.com/)
* **Autenticaci√≥n:** [Passport.js](http://www.passportjs.org/) & [JWT](https://jwt.io/)
* **Mailing:** [Nodemailer](https://nodemailer.com/)
* **Seguridad:** [Bcrypt](https://www.npmjs.com/package/bcrypt) para hashing de contrase√±as.

---

## üèóÔ∏è Arquitectura del Proyecto

El proyecto implementa una arquitectura de **dise√±o por capas** siguiendo los patrones m√°s utilizados en la industria:

* **DAO (Data Access Object):** Gesti√≥n directa de la persistencia con la base de datos.
* **DTO (Data Transfer Object):** Filtrado de datos sensibles (ej. en la ruta `/current`).
* **Repository:** Capa intermedia para desacoplar la l√≥gica de datos de la l√≥gica de negocio.
* **Service Layer:** Contiene toda la l√≥gica de negocio (procesamiento de compras, validaciones).
* **Controllers:** Manejo de las peticiones HTTP y respuestas.
* **Middlewares:** Control de autenticaci√≥n, autorizaci√≥n por roles (RBAC) y manejo de errores.



---

## üåü Caracter√≠sticas Principales

### 1. Sistema de Autenticaci√≥n y Autorizaci√≥n
* Registro y Login con **JWT** almacenado en Cookies.
* Estrategia de **Passport-JWT** para proteger rutas.
* **RBAC (Role-Based Access Control):** * `Admin`: Puede gestionar productos (Crear, Editar, Borrar).
    * `User`: Puede gestionar su carrito y realizar compras.
    * `Premium`: Rol con permisos intermedios.

### 2. Gesti√≥n de Productos y Carrito
* CRUD completo de productos con persistencia en MongoDB.
* Sistema de carrito con l√≥gica de **Purchase**: Al finalizar una compra, se genera un **Ticket** √∫nico y se verifica el stock disponible.

### 3. Recuperaci√≥n de Contrase√±a (Mailing)
* Integraci√≥n con **Gmail** mediante Nodemailer.
* Env√≠o de correos con links de recuperaci√≥n que expiran en 1 hora.
* Validaci√≥n de seguridad: El sistema impide utilizar la contrase√±a anterior al restablecerla.

---

## üöÄ Instalaci√≥n y Uso

1.  **Clonar el repositorio:**
    ```bash
    git clone [https://github.com/GonzaloMartinezz/EntregaFinalBackII.git](https://github.com/GonzaloMartinezz/EntregaFinalBackII.git)
    cd EntregaFinalBackII
    ```

2.  **Instalar dependencias:**
    ```bash
    npm install
    ```

3.  **Configurar variables de entorno:**
    Crea un archivo `.env` basado en el `.env.example` y completa tus credenciales.

4.  **Iniciar el servidor:**
    ```bash
    npm run dev
    ```

---

## üõ°Ô∏è Endpoints Principales

| M√©todo | Endpoint | Descripci√≥n | Acceso |
| :--- | :--- | :--- | :--- |
| POST | `/api/sessions/login` | Inicia sesi√≥n y genera Cookie JWT | P√∫blico |
| GET | `/api/sessions/current` | Retorna datos del usuario (DTO) | Logueado |
| POST | `/api/sessions/password-reset-request` | Env√≠a mail de recuperaci√≥n | P√∫blico |
| POST | `/api/products` | Crea un nuevo producto | Admin |
| POST | `/api/carts/:cid/purchase` | Finaliza la compra y genera ticket | User |

---

## üë§ Autor
* **Gonzalo Mart√≠nez** - *Desarrollador Fullstack / Estudiante de Desarrollo de Software*
* LinkedIn: [www.linkedin.com/in/gonzalomartinezz2004]
* Portfolio: [https://mi-portafolioblogg.vercel.app/]
